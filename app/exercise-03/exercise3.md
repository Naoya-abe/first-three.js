# 演習 3: 「太陽と周回する地球」

## テーマ: 階層構造（Grouping）と親子関係

3D特有の **「親が動けば子も動く」** という概念（シーングラフ）を学びます。これができると、ロボットの腕や車のタイヤなどが作れるようになります。

### 📋 ミッション

* 真ん中に **赤い球体（太陽）** を置きます。
* その周りを回る **青い球体（地球）** を作ります。
* **重要:** 地球の座標 (`position`) を毎フレーム計算するのではなく、**「太陽と地球をまとめた透明な箱（グループ）」** を回すことで、公転を表現してください。
    * R3Fでは `<group>` タグを使います。
    * `<div />` の中に `div` を入れる感覚です。

#### 構造のヒント

```jsx
<group ref={groupRef}> {/* ← このグループ自体を useFrame で回す */}
  <mesh>太陽</mesh>
  <mesh position={[3, 0, 0]}>地球</mesh> {/* ← 中心からずらして置く */}
</group>
```

### 鍛えられるスキル
- <group> タグの使い方。
- ローカル座標（親からの相対位置）とワールド座標（世界での絶対位置）の感覚。
- 3Dシーンの構造化。

### 🚀 応用ミッション: 「月を実装せよ」
地球の周りを回る 「月（Moon）」 を追加し、「太陽の周りを回る地球の、さらに周りを回る月」 を再現してください。

#### 📋 追加ミッション
- 地球の近くに、小さくて色の違う球体（月）を配置します。
- 月は地球と一緒に太陽の周りを回りながら、地球の周りも公転させてください。

#### 💡 構造のヒント: 「入れ子（ネスト）」を極める
地球」を単なる球体 (`<mesh>`) ではなく、「地球圏グループ」 に格上げするのがポイントです。
- 地球グループ自体を回すことで、その子要素である「月」も一緒に動きます。
- さらに、その中で「月」自身の位置をずらすことで、公転軌道を表現できます。

```jsx
<group ref={solarSystemRef}> {/* 太陽系の回転（大元の公転） */}

  <Sun /> {/* 太陽は中心 [0,0,0] */}

  {/* 🌍 ここがポイント！地球単体ではなく「地球グループ」を置く */}
  {/* このグループ自体を別の useFrame で回すと、中の月が回ります */}
  <group position={[3, 0, 0]} ref={earthSystemRef}>

    <Earth /> {/* 地球本体はこのグループの中心 [0,0,0] */}

    <Moon position={[1, 0, 0]} />  {/* 月は地球グループの中で少しずらす */}

  </group>

</group>
```

#### 鍛えられるスキル
- 座標系の入れ子構造（ネスト） の完全な理解。
- 複数の useFrame と useRef を使った、独立したアニメーション制御。